import{r as c,j as e,D as N,d as u,e as v,f,B as h,X as w}from"./index-FgfazPn4.js";import{t as _}from"./SalesTab-BzpiJPMf.js";import"./SalesOverview-Blys1nif.js";import"./card-S-815Fh1.js";import"./badge-PQ_Xgg0c.js";import"./users-7LwHL_dG.js";import"./circle-alert-YIDi-HZf.js";import"./trending-up-_gLokptJ.js";import"./clock-UXFbK2OM.js";import"./circle-x-7G5sk1I3.js";import"./circle-check-big-B5GuSQz3.js";import"./checkbox-De7F5xfH.js";import"./printer-X5np4qGe.js";import"./input-Cc5DIsqr.js";import"./label-C7AHjZf1.js";import"./usePurchaseOrdersEnhanced-5S0vZqYc.js";import"./shopping-cart-Dlmx8wK6.js";import"./tabs-CXhmf9qd.js";import"./minus-QEom8Zbo.js";import"./file-text-hP0IkulY.js";import"./eye-BJula9yD.js";import"./upload-BCc2dJv1.js";const Y=({isOpen:r,onClose:d,purchaseOrder:t})=>{const[n,p]=c.useState([]),[j,x]=c.useState(!1);c.useEffect(()=>{r&&t.client_po&&g()},[r,t.client_po]);const g=async()=>{if(t.client_po){x(!0);try{const i=(await _.getAllTransactions()).filter(o=>o.purchase_order_number===t.client_po||o.sales_invoice_number===t.client_po||o.delivery_receipt_number===t.client_po);p(i)}catch(s){console.error("Error fetching related transactions:",s)}finally{x(!1)}}},b=()=>{window.print()},a=[...t.items||[],...n.map(s=>({id:s.id,model:s.model,quantity:s.quantity,unit_price:s.unit_price,total_price:s.total_price,isFromTransaction:!0}))],l=a.reduce((s,i)=>s+(i.total_price||0),0),m=l*.12,y=l+m;return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
          @media print {
            body * {
              visibility: hidden !important;
            }
            #purchase-invoice-preview, #purchase-invoice-preview * {
              visibility: visible !important;
            }
            #purchase-invoice-preview {
              position: absolute !important;
              left: 0; top: 0; width: 100vw; min-height: 100vh;
              background: white !important;
              box-shadow: none !important;
              margin: 0 !important;
              padding: 20px !important;
              z-index: 9999 !important;
            }
            .no-print {
              display: none !important;
            }
          }
        `}),e.jsx(N,{open:r,onOpenChange:d,children:e.jsxs(u,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(v,{className:"no-print",children:e.jsxs(f,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Purchase Invoice Preview"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(h,{onClick:b,variant:"outline",size:"sm",children:"Print"}),e.jsx(h,{onClick:d,variant:"ghost",size:"sm",children:e.jsx(w,{className:"h-4 w-4"})})]})]})}),e.jsxs("div",{id:"purchase-invoice-preview",className:"bg-white p-8 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start border-b pb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-blue-800",children:"TechPinoy"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Your Trusted Tech Partner"}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[e.jsx("p",{children:"Unit 2A, 2nd Floor, 1010 Metropolitan Ave"}),e.jsx("p",{children:"Makati, Metro Manila, Philippines"}),e.jsx("p",{children:"Phone: +63 2 1234 5678 | Email: info@techpinoy.com"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h2",{className:"text-2xl font-bold text-blue-800 mb-2",children:"PURCHASE INVOICE"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Invoice #:"})," PI-",t.id.slice(0,8)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"PO #:"})," ",t.id.slice(0,8)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Client PO #:"})," ",t.client_po||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Date:"})," ",new Date(t.created_at).toLocaleDateString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs ${t.status==="completed"?"bg-green-100 text-green-800":t.status==="partial"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:t.status.toUpperCase()})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800 mb-2 border-b",children:"SUPPLIER INFORMATION"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",t.supplier_name||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Address:"})," N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Phone:"})," N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," N/A"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800 mb-2 border-b",children:"BILL TO"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsx("p",{children:e.jsx("strong",{children:"TechPinoy"})}),e.jsx("p",{children:"Unit 2A, 2nd Floor, 1010 Metropolitan Ave"}),e.jsx("p",{children:"Makati, Metro Manila, Philippines"}),e.jsx("p",{children:"Phone: +63 2 1234 5678"})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-bold text-gray-800",children:"ITEMS"}),j&&e.jsx("span",{className:"text-sm text-gray-500",children:"Loading related transactions..."})]}),e.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-blue-800 text-white",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-left",children:"Description"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Qty"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-right",children:"Unit Price"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-right",children:"Total"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2 text-center",children:"Source"})]})}),e.jsx("tbody",{children:a.length>0?a.map((s,i)=>e.jsxs("tr",{className:i%2===0?"bg-gray-50":"bg-white",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.model||"N/A"}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:s.quantity}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2 text-right",children:["₱",s.unit_price.toLocaleString("en-US",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"border border-gray-300 px-4 py-2 text-right",children:["₱",s.total_price.toLocaleString("en-US",{minimumFractionDigits:2})]}),e.jsx("td",{className:"border border-gray-300 px-4 py-2 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.isFromTransaction?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:s.isFromTransaction?"Transaction":"Purchase Order"})})]},`${s.id}-${i}`)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"border border-gray-300 px-4 py-8 text-center text-gray-500",children:"No items found"})})})]})]}),n.length>0&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-bold text-blue-800 mb-2",children:"Related Transaction Records"}),e.jsxs("p",{className:"text-sm text-blue-700",children:["Found ",n.length," related transaction record(s) matching Client PO: ",t.client_po]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("div",{className:"w-80",children:e.jsx("table",{className:"w-full",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 text-right font-medium",children:"Subtotal:"}),e.jsxs("td",{className:"py-2 text-right",children:["₱",l.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 pr-4 text-right font-medium",children:"VAT (12%):"}),e.jsxs("td",{className:"py-2 text-right",children:["₱",m.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),e.jsxs("tr",{className:"border-t-2 border-gray-800",children:[e.jsx("td",{className:"py-2 pr-4 text-right font-bold text-lg",children:"Total Amount:"}),e.jsxs("td",{className:"py-2 text-right font-bold text-lg",children:["₱",y.toLocaleString("en-US",{minimumFractionDigits:2})]})]})]})})})}),e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"Payment Status:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs ${t.payment_status==="paid"?"bg-green-100 text-green-800":t.payment_status==="partial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:t.payment_status.toUpperCase()})]})}),e.jsx("div",{className:"text-right text-xs text-gray-500",children:e.jsxs("p",{children:["Generated on: ",new Date().toLocaleDateString()]})})]})}),t.notes&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-bold text-gray-800 mb-2",children:"NOTES"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.notes})]}),e.jsxs("div",{className:"border-t pt-4 text-center text-xs text-gray-500",children:[e.jsx("p",{children:"Thank you for your business!"}),e.jsx("p",{className:"mt-1",children:"This is a computer-generated document. No signature required."})]})]})]})})]})};export{Y as PurchaseInvoicePreview};
//# sourceMappingURL=PurchaseInvoicePreview-D8CbYxXA.js.map
