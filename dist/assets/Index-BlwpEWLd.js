import{c as os,r as s,j as e,B as q,s as B,u as ys,X,a as cs,b as ds,L as ts,P as se,C as Ke,D as ms,d as xs,e as Ns,f as us,g as Ye,A as hs,h as vs,i as ws,T as Ss}from"./index-FgfazPn4.js";import{C as me,a as xe}from"./card-S-815Fh1.js";import{I as Q}from"./input-Cc5DIsqr.js";import{A as Cs,m as ks,P as Ps}from"./ProductDetailsModal-BJyiyVc3.js";import{u as Je,p as J,a as Ve}from"./clientService-scOH6ADK.js";import{B as U}from"./badge-PQ_Xgg0c.js";import{D as Ds,a as Ts,b as Ls,c as Ge,u as ps}from"./useSuppliers-CWirxHH7.js";import{S as Ee}from"./shopping-cart-Dlmx8wK6.js";import{C as As}from"./label-C7AHjZf1.js";import{A as _s}from"./AddPurchaseModal-DW33EB1L.js";import{C as Ms,T as Is,a as gs,S as _e,D as zs,b as Es,F as Rs,u as Fs,A as as}from"./SalesTab-BzpiJPMf.js";import{S as ue,T as fs}from"./checkbox-De7F5xfH.js";import{U as Os}from"./user-L0Nw7dze.js";import{S as He,B as ze}from"./settings-T9C6ttIn.js";import{P as he}from"./printer-X5np4qGe.js";import{P as Xe,U as Re,D as qs}from"./users-7LwHL_dG.js";import{F as Ze}from"./file-text-hP0IkulY.js";import{E as rs}from"./eye-BJula9yD.js";import{D as Us,C as Bs}from"./ClientListModal-BmJzvTJR.js";import{C as $s}from"./chevron-right-BqyfOyy6.js";import{H as Ws}from"./house-ChLT9mi7.js";import{S as ls}from"./SalesOverview-Blys1nif.js";import{T as Qs,a as Vs,b as Me,c as Ie}from"./tabs-CXhmf9qd.js";import{C as Gs}from"./clock-UXFbK2OM.js";import"./circle-check-big-B5GuSQz3.js";import"./trending-up-_gLokptJ.js";import"./usePurchaseOrdersEnhanced-5S0vZqYc.js";import"./minus-QEom8Zbo.js";import"./circle-alert-YIDi-HZf.js";import"./circle-x-7G5sk1I3.js";import"./upload-BCc2dJv1.js";import"./database-RojKuwWx.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=os("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=os("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),Ys={position:"fixed",zIndex:1e4,left:0,top:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center"},Js={background:"#fff",borderRadius:8,maxWidth:400,width:"100%",padding:24,boxShadow:"0 8px 32px rgba(0,0,0,0.2)",position:"relative"},Xs=({isOpen:r,onClose:o})=>{const[i,b]=s.useState(null),[c,g]=s.useState(""),[p,N]=s.useState(""),[h,P]=s.useState(""),[v,u]=s.useState(""),[d,m]=s.useState(""),[l,j]=s.useState(""),[M,C]=s.useState(""),[_,R]=s.useState(!1);s.useEffect(()=>{r&&((async()=>{var $;const{data:y,error:F}=await B.auth.getUser();y!=null&&y.user&&(b(y.user),g((($=y.user.user_metadata)==null?void 0:$.name)||""),N(y.user.email||""))})(),j(""),C(""),P(""),u(""),m(""))},[r]);const D=async()=>{var f;R(!0),j(""),C("");try{if(c!==((f=i==null?void 0:i.user_metadata)==null?void 0:f.name)){const{error:y}=await B.auth.updateUser({data:{name:c}});if(y)throw y}if(p!==(i==null?void 0:i.email)){const{error:y}=await B.auth.updateUser({email:p});if(y)throw y}j("Profile updated successfully.")}catch(y){C(y.message||"Failed to update profile.")}R(!1)},L=async f=>{if(f.preventDefault(),j(""),C(""),!h||!v||!d){C("All password fields are required.");return}if(v!==d){C("New passwords do not match.");return}R(!0);try{const{error:y}=await B.auth.signInWithPassword({email:p,password:h});if(y){C("Old password is incorrect."),R(!1);return}const{error:F}=await B.auth.updateUser({password:v});F?C(F.message||"Failed to update password."):(j("Password updated successfully."),P(""),u(""),m(""))}catch{C("Failed to update password.")}R(!1)};return r?e.jsx("div",{style:Ys,onClick:o,children:e.jsxs("div",{style:Js,onClick:f=>f.stopPropagation(),children:[e.jsx("button",{onClick:o,style:{position:"absolute",right:16,top:16,background:"none",border:"none",fontSize:20,cursor:"pointer"},"aria-label":"Close",children:"Ã—"}),e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Account Settings"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Name"}),e.jsx(Q,{value:c,onChange:f=>g(f.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Email"}),e.jsx(Q,{value:p,onChange:f=>N(f.target.value)})]}),e.jsx(q,{className:"w-full mt-2",onClick:D,disabled:_,children:"Save Profile"})]}),e.jsxs("form",{className:"space-y-3 mt-6",onSubmit:L,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Old Password"}),e.jsx(Q,{type:"password",value:h,onChange:f=>P(f.target.value),autoComplete:"current-password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"New Password"}),e.jsx(Q,{type:"password",value:v,onChange:f=>u(f.target.value),autoComplete:"new-password"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Confirm New Password"}),e.jsx(Q,{type:"password",value:d,onChange:f=>m(f.target.value),autoComplete:"new-password"})]}),e.jsx(q,{className:"w-full",type:"submit",disabled:_,children:"Change Password"})]}),(l||M)&&e.jsx("div",{className:`mt-4 text-sm ${l?"text-green-600":"text-red-600"}`,children:l||M})]})}):null},Zs="/assets/textlogo-CdP8XYxa.png",et=({isOpen:r,onClose:o})=>{const{clients:i,loading:b}=Je(),[c,g]=s.useState(""),[p,N]=s.useState(""),[h,P]=s.useState(!0),[v,u]=s.useState(""),[d,m]=s.useState(""),[l,j]=s.useState([]),[M,C]=s.useState(!1),[_,R]=s.useState([]),[D,L]=s.useState(!1),[f,y]=s.useState(!1),[F,$]=s.useState(null),[te,ae]=s.useState(1),re=s.useRef(null),[H,K]=s.useState({}),[pe,Ne]=s.useState(!1),[le,Fe]=s.useState(2),[A,ve]=s.useState("Sales Invoice"),[ge,we]=s.useState(""),[ne,Se]=s.useState(""),[ie,oe]=s.useState(""),[Z,Oe]=s.useState(""),[Ce,ce]=s.useState(!1);ys(),s.useState("");const[es,ke]=s.useState("123"),[qe,Pe]=s.useState("2020-01-08"),[Ue,fe]=s.useState("text"),[ss,De]=s.useState([]),[Te,be]=s.useState(!1),[z,je]=s.useState(A==="Sales Invoice"),Le=s.useRef(null),I=i.find(t=>t.id===p);s.useEffect(()=>{let t=!1;return C(!0),(async()=>{try{const E=await J.searchProducts(d.trim()?d:"");t||j(E)}catch{t||j([])}finally{t||C(!1)}})(),()=>{t=!0}},[d]);const Be=t=>{$(t),ae(1),y(!0),setTimeout(()=>{var S;(S=re.current)==null||S.focus()},100)},$e=()=>{F&&te>0&&R(t=>[...t,{...F,quantity:te}]),y(!1),$(null),ae(1)},We=()=>{y(!1),$(null),ae(1)};s.useEffect(()=>{(async()=>{if(!p){K({});return}const S=Array.from(new Set(_.map(Y=>Y.id))),E={};for(const Y of S)try{const ye=await J.getProductWithClients(Y);if(ye&&ye.clients){const Ae=ye.clients.find(js=>js.client_id===p);E[Y]=Ae?Ae.quoted_price:0}else E[Y]=0}catch{E[Y]=0}K(E)})()},[p,_]);const a=_.reduce((t,S)=>t+(H[S.id]||0)*S.quantity,0),k=.12,T=a>0?a*k/(1+k):0,n=a-T,w=0,x=pe?n*(le/100):0,O=n-w+T-x;if(s.useEffect(()=>{je(A==="Sales Invoice")},[A,Ce]),!r)return null;if(h){const t=i.filter(S=>S.name.toLowerCase().includes(v.toLowerCase()));return e.jsx("div",{className:"fixed inset-0 z-50 flex flex-col bg-background safe-area-inset w-screen h-screen",children:e.jsx("div",{className:"flex-1 flex flex-col overflow-y-auto w-full h-full",children:e.jsx("div",{className:"p-0 flex-1 flex flex-col w-full h-full",children:e.jsxs("div",{className:"bg-card rounded-none shadow-none p-0 flex-1 flex flex-col w-full h-full",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-card flex flex-col gap-2 mb-3 pb-2 w-full",children:[e.jsxs("div",{className:"flex justify-between items-center px-4 pt-4",children:[e.jsx("h2",{className:"text-lg font-bold text-foreground",children:"Select Client"}),e.jsx("button",{onClick:o,className:"p-2 rounded-full hover:bg-muted transition-colors","aria-label":"Close",children:e.jsx(X,{className:"h-5 w-5 text-foreground"})})]}),e.jsx("div",{className:"px-4",children:e.jsx("input",{type:"text",placeholder:"Search clients...",value:v,onChange:S=>u(S.target.value),className:"w-full h-11 px-3 py-2 border border-border rounded-md text-sm bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary"})})]}),e.jsx("div",{className:"flex-1 max-h-full overflow-y-auto mt-3 space-y-1 px-4 pb-4",children:t.length===0?e.jsx("div",{className:"text-muted-foreground text-center py-8 text-sm",children:"No clients found"}):e.jsx("div",{className:"flex flex-col gap-2",children:t.map(S=>e.jsxs("button",{className:"w-full flex flex-col items-start p-3 rounded-xl bg-white shadow-sm border border-gray-200 hover:bg-blue-50 active:scale-[0.98] transition-all duration-150",onClick:()=>{N(S.id),P(!1)},children:[e.jsx("div",{className:"font-medium text-gray-900 text-base truncate w-full",children:S.name}),S.address&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 truncate w-full",children:S.address})]},S.id))})})]})})})})}const W=l.filter(t=>t.name.toLowerCase().includes(d.toLowerCase())||t.sku&&t.sku.toLowerCase().includes(d.toLowerCase())),Qe=()=>A==="Sales Invoice"?z?"paid":"unpaid":A==="Delivery Receipt"?z?"adv_delivery":"delivered":A==="Purchase Order"&&z?"paid":"unpaid";async function V(t){const S=new Date(c).toLocaleString("en-US",{month:"long"});for(const E of _){const Y=[t||"",c,"",(I==null?void 0:I.name)||"",E.sku||E.name,E.quantity,H[E.id]||0,(H[E.id]||0)*E.quantity,ie||"",ne||"",ge||""],ye={sheet:S,data:Y};try{(await fetch("https://kong.techpinoy.com/functions/v1/google-sheets-handler",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ye)})).ok||console.error("Failed to write sale to Google Sheets")}catch{console.error("Network or CORS error sending to Google Sheets")}}}const G=async()=>{if(!c||isNaN(new Date(c).getTime())){be(!0);return}ce(!0)},de=async()=>{const t=Qe();await V(t),ce(!1),o()},ee=()=>{ce(!1)};return e.jsxs(e.Fragment,{children:[D&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-end justify-center bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-card rounded-t-2xl shadow-2xl w-full max-h-[85vh] flex flex-col safe-area-inset-bottom",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2 text-foreground",children:[e.jsx(Ee,{className:"w-5 h-5 text-primary"}),"Add Item to Sale"]})}),e.jsxs("div",{className:"p-4 flex-1 overflow-y-auto",children:[e.jsx(Q,{type:"text",placeholder:"Search products to add...",value:d,onChange:t=>m(t.target.value),className:"mb-3 h-11 text-sm"}),e.jsx("div",{className:"bg-background border border-border rounded-lg shadow-sm max-h-64 overflow-y-auto",children:M?e.jsx("div",{className:"p-4 text-center text-muted-foreground text-sm",children:"Searching..."}):W.length===0?e.jsx("div",{className:"p-4 text-center text-muted-foreground text-sm",children:"No products found"}):W.map(t=>e.jsx("div",{className:"flex items-center justify-between p-3 border-b last:border-b-0 hover:bg-muted transition cursor-pointer active:bg-muted/70",onClick:()=>Be(t),children:e.jsxs("div",{className:"flex items-center gap-3 w-full min-w-0",children:[t.color&&e.jsx("span",{className:"inline-block w-4 h-4 rounded-full border border-border flex-shrink-0",style:{backgroundColor:t.color},title:t.color}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("div",{className:"font-medium text-foreground text-sm truncate",children:t.name}),t.sku&&e.jsxs("div",{className:"text-xs text-muted-foreground truncate",children:["(",t.sku,")"]})]})]})},t.id))})]}),e.jsx("div",{className:"p-4 border-t border-border",children:e.jsx("button",{className:"w-full h-11 rounded-md bg-muted hover:bg-muted/80 text-foreground font-medium text-sm transition-colors",onClick:()=>L(!1),children:"Done"})})]})}),f&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-card rounded-xl shadow-2xl w-full max-w-xs",children:[e.jsxs("div",{className:"p-4 text-center",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-3 flex items-center justify-center gap-2 text-foreground",children:[e.jsx(Ee,{className:"w-5 h-5 text-primary"}),"Enter Quantity"]}),e.jsx("input",{ref:re,type:"number",min:1,value:te,onChange:t=>ae(Number(t.target.value)),className:"w-full border border-border rounded-md px-3 py-2 text-lg bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary h-11"})]}),e.jsxs("div",{className:"flex gap-2 p-4 pt-0",children:[e.jsx("button",{className:"flex-1 h-11 rounded-md bg-muted hover:bg-muted/80 text-foreground font-medium text-sm transition-colors",onClick:We,children:"Cancel"}),e.jsx("button",{className:"flex-1 h-11 rounded-md bg-primary hover:bg-primary/90 text-primary-foreground font-medium text-sm transition-colors disabled:opacity-50",onClick:$e,disabled:te<1,children:"Add"})]})]})}),e.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col bg-background safe-area-inset",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full p-3 bg-muted/50 border-b border-border sticky top-0 z-10",children:[e.jsx("span",{className:"text-sm font-semibold text-foreground",children:"New Sale"}),e.jsxs("select",{className:"h-8 text-xs px-2 py-0 rounded border border-border bg-background text-foreground flex-shrink-0",style:{minWidth:"90px"},value:A,onChange:t=>ve(t.target.value),children:[e.jsx("option",{value:"Sales Invoice",children:"Sales Invoice"}),e.jsx("option",{value:"Purchase Order",children:"Purchase Order"}),e.jsx("option",{value:"Delivery Receipt",children:"Delivery Receipt"})]}),e.jsx("button",{type:"button",className:"h-8 w-8 flex items-center justify-center rounded bg-background hover:bg-muted border border-border text-foreground flex-shrink-0","aria-label":"Select date",onClick:()=>{var t;return(t=Le.current)==null?void 0:t.click()},children:e.jsx(As,{className:"h-4 w-4"})}),e.jsx("input",{ref:Le,type:"date",value:c,onChange:t=>g(t.target.value),className:"hidden"}),e.jsx("button",{onClick:o,className:"h-8 w-8 flex items-center justify-center rounded-full hover:bg-muted transition ml-auto flex-shrink-0","aria-label":"Close",children:e.jsx(X,{className:"h-5 w-5 text-foreground"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto pb-20",children:e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-card rounded-lg p-3 shadow-sm",children:[e.jsx("img",{src:Zs,alt:"TechPinoy Logo",className:"h-8 w-auto mb-2"}),e.jsxs("div",{className:"text-xs text-muted-foreground space-y-0.5",children:[e.jsx("div",{children:"2474 Valerio Street"}),e.jsx("div",{children:"Pasay City 1300"}),e.jsx("div",{children:"Phone: +639 7711 88880"}),e.jsx("div",{children:"Website: https://techpinoy.com"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[I&&e.jsxs("div",{className:"bg-card rounded-lg p-3 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("div",{className:"bg-primary text-primary-foreground text-xs font-bold px-2 py-1 rounded",children:"BILL TO"}),e.jsx("button",{className:"h-8 w-8 flex items-center justify-center rounded-full bg-muted hover:bg-muted/80 text-foreground border border-border",onClick:()=>P(!0),type:"button","aria-label":"Change client",children:e.jsx(Ks,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"text-xs text-foreground space-y-0.5",children:[I.name&&e.jsx("div",{className:"font-medium",children:I.name}),I.address&&e.jsx("div",{children:I.address}),I.phone&&e.jsx("div",{children:I.phone})]})]}),e.jsxs("div",{className:"bg-card rounded-lg p-3 shadow-sm",children:[e.jsx("div",{className:"text-lg font-bold text-primary tracking-wide mb-2",children:A.toUpperCase()}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"DATE"}),e.jsx("span",{className:"text-xs text-foreground font-medium",children:c||"mm/dd/yyyy"})]}),A==="Sales Invoice"&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"INVOICE #"}),e.jsx("input",{type:"text",value:ie,onChange:t=>oe(t.target.value),className:"border border-border rounded px-2 py-1 text-xs w-20 bg-background text-foreground"})]}),A==="Purchase Order"&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"PO #"}),e.jsx("input",{type:"text",value:ge,onChange:t=>we(t.target.value),className:"border border-border rounded px-2 py-1 text-xs w-20 bg-background text-foreground"})]}),A==="Delivery Receipt"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"DR #"}),e.jsx("input",{type:"text",value:ne,onChange:t=>Se(t.target.value),className:"border border-border rounded px-2 py-1 text-xs w-20 bg-background text-foreground"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"PO #"}),e.jsx("input",{type:"text",value:ge,onChange:t=>we(t.target.value),className:"border border-border rounded px-2 py-1 text-xs w-20 bg-background text-foreground"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"CUSTOMER ID"}),e.jsx("input",{type:"text",value:es,onChange:t=>ke(t.target.value),className:"border border-border rounded px-2 py-1 text-xs w-20 bg-background text-foreground"})]}),A!=="Sales Invoice"&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"DUE DATE"}),e.jsx("input",{type:Ue,value:qe,onChange:t=>Pe(t.target.value),onFocus:()=>fe("date"),onBlur:()=>fe("text"),className:"border border-border rounded px-2 py-1 text-xs w-20 bg-background text-foreground",placeholder:"mm/dd/yyyy"})]})]})]})]})]}),_.length>0&&e.jsx("div",{className:"bg-card rounded-lg shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-muted",children:[e.jsx("th",{className:"px-2 py-2 text-left font-medium",children:"Item"}),e.jsx("th",{className:"px-2 py-2 text-left font-medium",children:"Desc."}),e.jsx("th",{className:"px-2 py-2 text-center font-medium",children:"Qty"}),e.jsx("th",{className:"px-2 py-2 text-right font-medium",children:"Price"}),e.jsx("th",{className:"px-2 py-2 text-right font-medium",children:"Amt."})]})}),e.jsx("tbody",{children:_.map((t,S)=>e.jsxs("tr",{className:"border-b border-border last:border-b-0",children:[e.jsx("td",{className:"px-2 py-2 text-foreground",children:t.sku}),e.jsx("td",{className:"px-2 py-2 text-foreground",children:e.jsx("div",{className:"truncate max-w-[80px]",title:t.name,children:t.name})}),e.jsx("td",{className:"px-2 py-2 text-center text-foreground",children:t.quantity}),e.jsxs("td",{className:"px-2 py-2 text-right text-foreground",children:["â‚±",(H[t.id]||0).toLocaleString()]}),e.jsxs("td",{className:"px-2 py-2 text-right text-foreground font-medium",children:["â‚±",((H[t.id]||0)*t.quantity).toLocaleString()]})]},t.id+S))})]})})}),A!=="Delivery Receipt"&&e.jsx("div",{className:"bg-card rounded-lg shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx("table",{className:"w-full text-xs",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"border-b border-border px-3 py-2 font-medium text-foreground",children:"Total (Incl.)"}),e.jsxs("td",{className:"border-b border-border px-3 py-2 text-right font-bold text-green-600",children:["â‚±",a.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border-b border-border px-3 py-2 text-foreground",children:"Less: VAT"}),e.jsxs("td",{className:"border-b border-border px-3 py-2 text-right text-foreground",children:["â‚±",T.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border-b border-border px-3 py-2 text-foreground",children:"Net of VAT"}),e.jsxs("td",{className:"border-b border-border px-3 py-2 text-right text-foreground",children:["â‚±",n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border-b border-border px-3 py-2 text-foreground",children:"Discount"}),e.jsxs("td",{className:"border-b border-border px-3 py-2 text-right text-foreground",children:["â‚±",w.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border-b border-border px-3 py-2 text-foreground",children:"Add: VAT"}),e.jsxs("td",{className:"border-b border-border px-3 py-2 text-right text-foreground",children:["â‚±",T.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border-b border-border px-3 py-2",children:e.jsxs("label",{className:"flex items-center gap-2 text-xs",children:[e.jsx("input",{type:"checkbox",checked:pe,onChange:t=>Ne(t.target.checked),className:"accent-primary"}),e.jsx("span",{className:"text-foreground",children:"Withhold."}),e.jsx("input",{type:"number",min:0,max:100,value:le,onChange:t=>Fe(Number(t.target.value)),className:"w-8 px-1 py-0.5 border border-border rounded text-xs bg-background text-foreground",disabled:!pe}),e.jsx("span",{className:"text-foreground",children:"%"})]})}),e.jsxs("td",{className:"border-b border-border px-3 py-2 text-right text-foreground",children:["â‚±",x.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsx("tr",{children:e.jsx("td",{className:"border-b border-border px-3 py-3 font-bold text-base text-center text-foreground",colSpan:2,children:"TOTAL DUE"})}),e.jsx("tr",{children:e.jsxs("td",{className:"px-3 py-3 font-bold text-lg text-center text-green-600",colSpan:2,children:["â‚±",O.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})})]})})})})]})}),e.jsxs("div",{className:"fixed bottom-0 left-0 w-full bg-card border-t border-border p-3 flex items-center justify-between gap-2 z-20 safe-area-inset-bottom",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("label",{className:"inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*,application/pdf",multiple:!0,className:"hidden",onChange:t=>{t.target.files&&De(Array.from(t.target.files))}}),e.jsx("button",{type:"button",className:"flex items-center justify-center h-9 w-9 rounded-full bg-muted hover:bg-muted/80 text-foreground",tabIndex:0,"aria-label":"Attach File",children:e.jsx(Hs,{className:"h-4 w-4"})})]}),e.jsx("button",{className:"h-9 w-9 flex items-center justify-center rounded-full bg-muted hover:bg-muted/80 text-foreground",onClick:o,"aria-label":"Cancel",children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx("button",{className:"h-9 px-4 text-xs rounded-md bg-primary hover:bg-primary/90 text-primary-foreground font-medium",onClick:G,children:"Complete"})]}),e.jsx("button",{className:"h-9 px-4 text-xs rounded-md bg-primary hover:bg-primary/90 text-primary-foreground font-medium shadow-sm",onClick:()=>L(!0),children:"+ Add"})]})]}),Z&&e.jsx("div",{className:"fixed bottom-20 left-4 right-4 bg-destructive/10 text-destructive px-4 py-2 rounded-md text-center font-medium text-sm safe-area-inset-bottom",children:Z}),Ce&&e.jsx("div",{className:"fixed inset-0 z-[200] flex items-end justify-center bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-card rounded-t-2xl shadow-2xl w-full max-h-[85vh] flex flex-col safe-area-inset-bottom",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsx("h3",{className:"text-lg font-bold text-primary text-center",children:A})}),e.jsx("div",{className:"p-4 flex-1 overflow-y-auto",children:e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-foreground",children:"Date:"})," ",e.jsx("span",{className:"text-muted-foreground",children:c})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-foreground",children:"Client:"})," ",e.jsx("span",{className:"text-muted-foreground",children:(I==null?void 0:I.name)||"-"})]}),e.jsx("div",{className:"font-medium text-foreground",children:"Items:"}),e.jsx("div",{className:"bg-muted rounded-md p-3 space-y-1",children:_.map((t,S)=>e.jsxs("div",{className:"text-xs text-foreground",children:[t.sku||t.name," x ",t.quantity," = â‚±",((H[t.id]||0)*t.quantity).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]},t.id+S))}),e.jsxs("div",{className:"font-bold text-primary text-base",children:["Total: â‚±",_.reduce((t,S)=>t+(H[S.id]||0)*S.quantity,0).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx("input",{type:"checkbox",id:"confirm-checkbox",checked:z,onChange:t=>je(t.target.checked),className:"accent-primary"}),e.jsxs("label",{htmlFor:"confirm-checkbox",className:"font-medium text-foreground text-sm",children:[A==="Sales Invoice"&&"Paid",A==="Delivery Receipt"&&"Adv Delivery",A==="Purchase Order"&&"Paid"]})]})]})}),e.jsxs("div",{className:"flex gap-2 p-4 border-t border-border",children:[e.jsx("button",{className:"flex-1 h-11 rounded-md bg-muted hover:bg-muted/80 text-foreground font-medium",onClick:ee,children:"Cancel"}),e.jsx("button",{className:"flex-1 h-11 rounded-md bg-primary hover:bg-primary/90 text-primary-foreground font-medium",onClick:de,children:"Confirm & Complete"})]})]})}),Te&&e.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-card rounded-xl shadow-2xl w-full max-w-xs",children:[e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("h3",{className:"text-lg font-bold mb-3 text-foreground",children:"Select Date for this transaction"}),e.jsx("input",{type:"date",className:"w-full h-11 px-3 py-2 border border-border rounded-md text-sm bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary/20 focus:border-primary",value:c,onChange:t=>g(t.target.value)})]}),e.jsx("div",{className:"p-4 pt-0",children:e.jsx("button",{className:"h-11 w-full rounded-md bg-primary hover:bg-primary/90 text-primary-foreground font-medium disabled:opacity-50",disabled:!c||isNaN(new Date(c).getTime()),onClick:()=>{be(!1),ce(!0)},children:"Confirm Date"})})]})})]})};function st({open:r,onClose:o}){const[i,b]=s.useState("google"),[c,g]=s.useState(null);return r?e.jsx("div",{className:"fixed inset-0 z-[20000] flex items-center justify-center bg-black/70",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl h-[90vh] rounded-lg shadow-lg flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Developer Mode"}),e.jsx("button",{onClick:o,className:"text-gray-500 hover:text-red-500 text-2xl",children:"Ã—"})]}),e.jsx("div",{className:"flex border-b",children:e.jsx("button",{className:`px-4 py-2 ${i==="google"?"border-b-2 border-blue-500 font-bold":""}`,onClick:()=>b("google"),children:"Google Services"})}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:i==="google"&&e.jsxs("div",{children:[e.jsx("button",{onClick:async()=>{g("Sending...");const p={saleDate:new Date().toISOString(),customer:"Test Customer",amount:123.45,product:"Test Product"},N=new Date().toLocaleString("en-US",{month:"long"});try{(await fetch("https://kong.techpinoy.com/functions/v1/google-sheets-handler",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sheet:N,data:p})})).ok?g("Success! Data sent to Google Sheet."):g("Failed! Server error.")}catch{g("Failed! Network or CORS error.")}},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Send Test Data to Google Sheet"}),c&&e.jsx("div",{style:{marginTop:8},children:c})]})})]})}):null}const tt=({value:r,onChange:o,placeholder:i,className:b=""})=>e.jsxs("div",{className:`relative w-full ${b}`,children:[e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4 z-10"}),e.jsx(Q,{placeholder:i,value:r,onChange:c=>o(c.target.value),className:"w-full pl-10 pr-10 py-2 text-sm bg-white border-gray-200 rounded-lg focus:border-blue-400 focus:ring-2 focus:ring-blue-200 transition-all duration-200"}),r&&e.jsx("button",{type:"button",onClick:()=>o(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-1 rounded-full hover:bg-gray-100 transition-colors",children:e.jsx(X,{className:"h-4 w-4 text-gray-400"})})]}),at={black:"bg-black",cyan:"bg-cyan-500",magenta:"bg-pink-500",yellow:"bg-yellow-400"},rt=({color:r})=>{const o=at[r==null?void 0:r.toLowerCase()]||"bg-gray-400";return e.jsx("div",{className:`w-3 h-3 rounded-full ${o}`})};function lt({open:r,onClose:o}){return r?e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-0 w-full max-w-4xl flex flex-col items-stretch relative max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(Ze,{className:"h-5 w-5"})," Transaction Records"]}),e.jsx("button",{className:"p-2 rounded-full hover:bg-gray-100 text-gray-500",onClick:o,"aria-label":"Close",children:e.jsx(X,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-6 pt-2 overflow-y-auto",children:e.jsx(Is,{})})]})}):null}const nt=()=>{const[r,o]=s.useState(""),[i,b]=s.useState("products"),[c,g]=s.useState(!1),[p,N]=s.useState(null),[h,P]=s.useState(null),[v,u]=s.useState(!1),[d,m]=s.useState([]),[l,j]=s.useState([]),[M,C]=s.useState({}),[_,R]=s.useState({}),[D,L]=s.useState(!1),[f,y]=s.useState(!1),[F,$]=s.useState(!1),[te,ae]=s.useState(!1);Je();const[re,H]=s.useState("");s.useState("");const[K,pe]=s.useState(""),[Ne,le]=s.useState([]),[Fe,A]=s.useState(!1),[ve,ge]=s.useState([]),[we,ne]=s.useState(!1),[Se,ie]=s.useState(null),[oe,Z]=s.useState(1),Oe=s.useRef(null),[Ce,ce]=s.useState(!1),[es,ke]=s.useState({}),[qe,Pe]=s.useState(!1),[Ue,fe]=s.useState(!1),[ss,De]=s.useState(!1);s.useState("google"),s.useState(null);const[Te,be]=s.useState(!1),{userProfile:z}=cs();ds();const je=a=>{ie(a),Z(1),ne(!0),setTimeout(()=>{var k;(k=Oe.current)==null||k.focus()},100)},Le=()=>{Se&&oe>0&&ge(a=>[...a,{...Se,quantity:oe}]),ne(!1),ie(null),Z(1)};s.useEffect(()=>{if(!r.trim()){m([]),j([]);return}let a=!1;const T=setTimeout(async()=>{g(!0),N(null);try{if(i==="products"){let n=[];try{n=await J.searchProducts(r)}catch{console.log("Direct product search failed, trying printer-based search")}if(n.length===0)try{const x=await Ve.searchPrinters(r);n=(await Promise.all(x.map(async V=>{try{const{data:G,error:de}=await B.from("product_printers").select("product:products(*)").eq("printer_id",V.id).order("product(name)",{ascending:!0}).order("product(color)",{ascending:!0});return(G||[]).map(ee=>ee.product).filter(Boolean)}catch{return[]}}))).flat().filter((V,G,de)=>G===de.findIndex(ee=>ee.id===V.id))}catch{console.log("Printer-based product search failed")}const w=await Promise.all(n.map(async x=>{try{const[O,W]=await Promise.all([J.getProductWithSuppliers(x.id),J.getProductWithClients(x.id)]);return{...x,suppliers:(O==null?void 0:O.suppliers)||[],clients:(W==null?void 0:W.clients)||[],color:x.color}}catch{return{...x,suppliers:[],clients:[],color:x.color}}}));a||m(w)}else{let n=[];try{n=await Ve.searchPrinters(r)}catch{console.log("Direct printer search failed, trying product-based search")}if(n.length===0)try{const x=await J.searchProducts(r);n=(await Promise.all(x.map(async V=>{try{return await Ve.getProductPrinters(V.id)}catch{return[]}}))).flat().filter((V,G,de)=>G===de.findIndex(ee=>ee.id===V.id))}catch{console.log("Product-based printer search failed")}const w=await Promise.all(n.map(async x=>{try{const O=await B.from("product_printers").select("product:products(*)").eq("printer_id",x.id).order("product(name)",{ascending:!0}).order("product(color)",{ascending:!0});return{...x,compatibleProducts:(O.data||[]).map(W=>W.product).filter(Boolean)}}catch{return{...x,compatibleProducts:[]}}}));a||j(w)}}catch(n){a||(N(n instanceof Error?n.message:"Search failed"),m([]),j([]))}finally{a||g(!1)}},300);return()=>{a=!0,clearTimeout(T)}},[r,i]),s.useEffect(()=>{if(!f||!K.trim()){le([]);return}let a=!1;A(!0);const k=setTimeout(async()=>{try{const T=await J.searchProducts(K);a||le(T)}catch{a||le([])}finally{a||A(!1)}},300);return()=>{a=!0,clearTimeout(k)}},[K,f]);const I=()=>{u(!1),P(null)},Be=a=>{C(k=>({...k,[a]:!k[a]}))},$e=a=>{R(k=>({...k,[a]:!k[a]}))},We=a=>{var T;return(((T=a.printer_assignments)==null?void 0:T.filter(n=>n.status==="active"))||[]).length===0?{status:"available",label:"Available",color:"bg-green-100 text-green-700"}:{status:"assigned",label:"Currently Assigned",color:"bg-blue-100 text-blue-700"}};return s.useEffect(()=>{(async()=>{if(!re){ke({});return}const k=Array.from(new Set(ve.map(n=>n.id))),T={};for(const n of k)try{const w=await J.getProductWithClients(n);if(w&&w.clients){const x=w.clients.find(O=>O.client_id===re);T[n]=x?x.quoted_price:0}else T[n]=0}catch{T[n]=0}ke(T)})()},[re,ve]),e.jsxs(e.Fragment,{children:[Ce&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-lg flex flex-col items-center relative",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add Item to Sale"}),e.jsx(Q,{type:"text",placeholder:"Search products to add...",value:K,onChange:a=>pe(a.target.value),className:"mb-2"}),K.trim()&&e.jsx("div",{className:"mt-2 bg-white border border-gray-200 rounded-lg shadow max-h-64 overflow-y-auto w-full",children:Fe?e.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:"Searching..."}):Ne.length===0?e.jsx("div",{className:"p-4 text-center text-gray-400 text-sm",children:"No products found"}):Ne.map(a=>e.jsx("div",{className:"flex items-center justify-between px-4 py-2 border-b last:border-b-0 hover:bg-orange-50 transition cursor-pointer",onClick:()=>je(a),children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["SKU: ",a.sku]}),a.color&&e.jsxs("div",{className:"text-xs text-gray-400",children:["Color: ",a.color]})]})},a.id))}),e.jsx("button",{className:"mt-4 px-4 py-2 rounded bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold",onClick:()=>ce(!1),children:"Close"})]})}),we&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 w-full max-w-xs flex flex-col items-center relative",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Enter Quantity"}),e.jsx("div",{className:"mb-4 w-full",children:e.jsx("input",{ref:Oe,type:"number",min:1,value:oe,onChange:a=>Z(Number(a.target.value)),className:"w-full border rounded px-3 py-2 text-lg focus:outline-none focus:ring-2 focus:ring-orange-400"})}),e.jsxs("div",{className:"flex gap-2 w-full",children:[e.jsx("button",{className:"flex-1 py-2 rounded bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold",onClick:()=>{ne(!1),ie(null),Z(1)},children:"Cancel"}),e.jsx("button",{className:"flex-1 py-2 rounded bg-orange-600 hover:bg-orange-700 text-white font-semibold",onClick:Le,disabled:oe<1,children:"Add"})]})]})}),f&&e.jsx(et,{isOpen:f,onClose:()=>y(!1)}),F&&e.jsx(_s,{isOpen:F,onClose:()=>$(!1)}),te&&e.jsx(Ms,{onClose:()=>ae(!1)}),Te&&e.jsx(lt,{open:Te,onClose:()=>be(!1)}),e.jsx("div",{className:`fixed bottom-0 left-0 w-full ${f?"z-0 pointer-events-none":"z-[10000]"}`,style:f?{opacity:.2}:{},children:e.jsx("div",{className:"w-full bg-white/95 backdrop-blur-lg border-t border-gray-200 shadow-2xl",children:e.jsxs("div",{className:"px-2 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs(Ds,{children:[e.jsx(Ts,{asChild:!0,children:e.jsx("button",{type:"button","aria-label":"Menu",className:"p-2 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-500 border border-gray-200",children:e.jsx(Os,{className:"h-5 w-5"})})}),e.jsxs(Ls,{align:"start",className:"w-48 z-[9999]",children:[e.jsxs(Ge,{onClick:()=>fe(!0),children:[e.jsx(He,{className:"mr-2 h-4 w-4"})," Account Settings"]}),e.jsxs(Ge,{onClick:()=>De(!0),children:[e.jsx(He,{className:"mr-2 h-4 w-4"})," Developer Mode"]}),e.jsxs(Ge,{onClick:async()=>{await B.auth.signOut(),window.location.href="/auth"},children:[e.jsx(ts,{className:"mr-2 h-4 w-4"})," Logout"]})]})]})}),(z==null?void 0:z.role)!=="client"&&e.jsx("div",{className:"flex-1",children:e.jsx(tt,{value:r,onChange:o,placeholder:"Search anything - products, printers, SKUs, models..."})}),(z==null?void 0:z.role)!=="client"&&e.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>b("printers"),className:`flex items-center justify-center p-2 rounded-lg transition-all duration-200
                      ${i==="printers"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
                    `,"aria-pressed":i==="printers",children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx("button",{type:"button",onClick:()=>b("products"),className:`flex items-center justify-center p-2 rounded-lg transition-all duration-200
                      ${i==="products"?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
                    `,"aria-pressed":i==="products",children:e.jsx(Xe,{className:"h-4 w-4"})})]}),(z==null?void 0:z.role)!=="client"&&e.jsxs("div",{className:"flex-shrink-0 relative",children:[e.jsx(Cs,{children:D&&e.jsx(ks.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:20,scale:.95},transition:{duration:.2,ease:"easeOut"},className:"absolute bottom-full right-0 mb-2 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-100 p-4 w-80 max-w-[90vw]",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add Options"}),e.jsx("button",{onClick:()=>L(!1),className:"p-1.5 rounded-full hover:bg-gray-100 transition-colors","aria-label":"Close menu",children:e.jsx(X,{className:"h-4 w-4 text-gray-500"})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>{L(!1),y(!0)},className:"w-full flex items-center gap-3 p-3 rounded-xl bg-orange-50 hover:bg-orange-100 border border-orange-200 transition-colors text-left",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"font-bold text-orange-600 text-lg",children:"S"})}),e.jsx("div",{children:e.jsx("h4",{className:"font-medium text-gray-900",children:"Sales"})})]}),e.jsxs("button",{onClick:()=>{L(!1),be(!0)},className:"w-full flex items-center gap-3 p-3 rounded-xl bg-violet-50 hover:bg-violet-100 border border-violet-200 transition-colors text-left",children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-violet-100 rounded-full flex items-center justify-center",children:e.jsx(Ze,{className:"text-violet-600 h-6 w-6"})}),e.jsx("div",{children:e.jsx("h4",{className:"font-medium text-gray-900",children:"Transaction Records"})})]})]})]})})}),e.jsxs("button",{type:"button",onClick:()=>L(!D),className:"flex items-center justify-center gap-2 px-4 py-2 rounded-lg bg-orange-600 hover:bg-orange-700 text-white font-semibold transition border border-orange-700 ml-2 hidden sm:flex",children:[e.jsx(se,{className:"h-5 w-5"}),e.jsx("span",{children:"Add"})]}),e.jsx("button",{type:"button",onClick:()=>L(!D),className:"p-2 rounded-full bg-orange-600 hover:bg-orange-700 text-white transition border border-orange-700 flex sm:hidden ml-2","aria-label":"Add",children:e.jsx(se,{className:"h-5 w-5"})})]})]}),r.trim()&&e.jsxs("div",{className:"w-full mb-2 max-h-96 overflow-y-auto bg-white/95 backdrop-blur-lg border border-gray-200 rounded-lg shadow-lg z-20 relative pt-2",children:[e.jsx("button",{type:"button",className:"sticky top-0 right-0 float-right m-2 p-1 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-500 hover:text-gray-700 transition border border-gray-300 shadow z-10","aria-label":"Close results",onClick:a=>{a.stopPropagation(),o("")},children:e.jsx(X,{className:"h-4 w-4"})}),c?e.jsx(Ke,{message:"Searching products"}):p?e.jsx("div",{className:"w-full text-center py-4",children:e.jsx("div",{className:"text-red-500 text-sm break-words",children:p})}):i==="products"?d.length>0?e.jsx("div",{className:"w-full space-y-3 p-1",children:d.map(a=>{const k=(a.suppliers||[]).filter(n=>n.current_price&&n.current_price>0),T=(a.clients||[]).filter(n=>n.quoted_price&&n.quoted_price>0);return e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-3 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-bold text-gray-900 text-lg leading-tight",children:a.name}),e.jsx("span",{className:"font-mono bg-gray-100 px-2 py-0.5 rounded text-xs",children:a.sku}),a.color&&e.jsx("span",{className:"inline-block w-3 h-3 rounded-full border ml-1",style:{backgroundColor:a.color}})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Supplier pricing:"}),e.jsx("button",{type:"button",className:"ml-2 px-2 py-0.5 rounded bg-blue-100 text-blue-700 text-xs font-semibold border border-blue-200 hover:bg-blue-200 transition",onClick:n=>{n.stopPropagation(),Be(a.id)},children:M[a.id]?"HIDE":e.jsx(rs,{className:"inline h-4 w-4"})})]}),k.length>0?M[a.id]?e.jsx("div",{className:"flex flex-wrap gap-1",children:k.map(n=>{var w,x;return e.jsxs("span",{className:"flex items-center gap-1 bg-blue-50 border border-blue-200 rounded px-2 py-1 text-base font-bold text-blue-800",children:[(w=n.supplier)==null?void 0:w.name,": ",e.jsxs("span",{className:"font-bold text-blue-900",children:["â‚±",(x=n.current_price)==null?void 0:x.toLocaleString()]})]},n.id)})}):e.jsxs("div",{className:"text-base text-blue-800 font-bold",children:["â‚±",Math.max(...k.map(n=>n.current_price)).toLocaleString()]}):e.jsx("div",{className:"text-xs text-gray-500",children:"No supplier pricing available"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Client pricing:"}),e.jsx("button",{type:"button",className:"ml-2 px-2 py-0.5 rounded bg-green-100 text-green-700 text-xs font-semibold border border-green-200 hover:bg-green-200 transition",onClick:n=>{n.stopPropagation(),$e(a.id)},children:_[a.id]?"HIDE":e.jsx(rs,{className:"inline h-4 w-4"})})]}),T.length>0?_[a.id]?e.jsx("div",{className:"flex flex-wrap gap-1",children:T.map(n=>{var w,x;return e.jsxs("span",{className:"flex items-center gap-1 bg-green-50 border border-green-200 rounded px-2 py-1 text-base font-bold text-green-800",children:[(w=n.client)==null?void 0:w.name,": ",e.jsxs("span",{className:"font-bold text-green-900",children:["â‚±",(x=n.quoted_price)==null?void 0:x.toLocaleString()]})]},n.id)})}):e.jsxs("div",{className:"text-base text-green-800 font-bold",children:["â‚±",Math.max(...T.map(n=>n.quoted_price)).toLocaleString()]}):e.jsx("div",{className:"text-xs text-gray-500",children:"No client pricing available"})]})]})},a.id)})}):e.jsxs("div",{className:"w-full text-center py-4",children:[e.jsx(ue,{className:"h-8 w-8 mx-auto mb-2 opacity-30 text-gray-400"}),e.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"No products found"}),e.jsx("p",{className:"text-xs text-gray-400 px-4 break-words",children:"Try searching for product names, SKUs, or printer names/models"})]}):l.length>0?e.jsx("div",{className:"w-full space-y-3 p-1",children:l.map(a=>{const k=We(a);return e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-3 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"w-14 h-14 flex-shrink-0 flex items-center justify-center bg-gray-100 rounded border overflow-hidden mr-3",children:a.image_url?e.jsx("img",{src:a.image_url,alt:a.name,className:"object-contain w-full h-full"}):e.jsx(he,{className:"h-8 w-8 text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"flex items-center space-x-2 mb-1",children:e.jsx("h4",{className:"font-medium text-sm",children:[a.manufacturer,a.series,a.model||a.name].filter(Boolean).join(" ")})}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(U,{variant:"secondary",className:`text-xs ${k.color}`,children:k.label}),a.rental_eligible&&e.jsx(U,{variant:"outline",className:"text-xs bg-blue-100 text-blue-800",children:"Rental Eligible"}),a.color&&e.jsx(U,{variant:"outline",className:"text-xs",children:a.color})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-xs text-gray-600 block mb-1",children:"Compatible Products:"}),a.compatibleProducts.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:(()=>{const T=a.compatibleProducts.reduce((n,w)=>{const x=`${w.name}-${w.sku}`;return n[x]||(n[x]={name:w.name,sku:w.sku,colors:[],allProducts:[]}),w.color&&!n[x].colors.includes(w.color)&&n[x].colors.push(w.color),n[x].allProducts.push(w),n},{});return Object.values(T).map((n,w)=>e.jsxs(U,{variant:"outline",className:"flex items-center space-x-1.5 text-xs bg-gray-50",children:[e.jsxs("span",{children:[n.name,n.sku&&` (${n.sku})`]}),n.colors.map(x=>e.jsx(rt,{color:x},x))]},w))})()}):e.jsx("span",{className:"text-xs text-gray-400",children:"No compatible products found"})]})]})]})]})},a.id)})}):e.jsxs("div",{className:"w-full text-center py-4",children:[e.jsx(ue,{className:"h-8 w-8 mx-auto mb-2 opacity-30 text-gray-400"}),e.jsx("p",{className:"text-gray-500 text-sm mb-1",children:"No printers found"}),e.jsx("p",{className:"text-xs text-gray-400 px-4 break-words",children:"Try searching for printer names, models, or product names/SKUs"})]})]})]})})}),v&&h&&e.jsx(Ps,{isOpen:v,onClose:I,product:h}),e.jsx(ms,{open:qe,onOpenChange:Pe,children:e.jsxs(xs,{children:[e.jsx(Ns,{children:e.jsx(us,{children:"Menu"})}),e.jsxs("div",{className:"py-4 text-center text-gray-600 flex flex-col gap-4",children:[e.jsxs(q,{variant:"outline",className:"w-full",onClick:()=>{Pe(!1)},children:[e.jsx(He,{className:"mr-2 h-4 w-4"})," Settings"]}),e.jsxs(q,{variant:"destructive",className:"w-full",onClick:async()=>{await B.auth.signOut(),window.location.href="/auth"},children:[e.jsx(ts,{className:"mr-2 h-4 w-4"})," Logout"]})]})]})}),e.jsx(Xs,{isOpen:Ue,onClose:()=>fe(!1)}),e.jsx(st,{open:ss,onClose:()=>De(!1)})]})},it=({isOpen:r,onClose:o,onSupplierSelected:i,title:b="Select a Supplier",description:c="Choose a supplier to view their details."})=>{const[g,p]=s.useState(""),{suppliers:N,loading:h}=ps(),P=s.useRef(null),v=s.useRef(null),u=s.useRef(null);s.useEffect(()=>{r&&u.current&&u.current.blur()},[r]),s.useEffect(()=>{if(!r)return;const m=l=>{l.key==="Escape"&&o()};return window.addEventListener("keydown",m),()=>window.removeEventListener("keydown",m)},[r,o]);const d=N.filter(m=>{var l;return m.name.toLowerCase().includes(g.toLowerCase())||((l=m.contact_email)==null?void 0:l.toLowerCase().includes(g.toLowerCase()))});return r?e.jsx("div",{className:"fixed inset-0 z-[10001] flex flex-col",role:"dialog","aria-modal":"true","aria-labelledby":"supplier-list-modal-title","aria-describedby":"supplier-list-modal-desc",children:e.jsxs("div",{ref:P,className:"relative z-10 flex flex-col h-full w-full bg-white shadow-2xl",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 z-20 bg-gradient-to-r from-green-50 to-emerald-50 border-b border-green-200 px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx(ze,{className:"w-5 h-5 text-green-500 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h2",{id:"supplier-list-modal-title",className:"text-base font-semibold text-gray-900 truncate",children:b}),e.jsx("p",{id:"supplier-list-modal-desc",className:"text-xs text-gray-600",children:c})]})]}),e.jsx("button",{onClick:o,className:"p-2 rounded-full hover:bg-green-200 transition-colors flex-shrink-0","aria-label":"Close",children:e.jsx(X,{className:"h-5 w-5 text-green-500"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{tabIndex:0,"aria-hidden":"true",style:{width:0,height:0,overflow:"hidden"}}),e.jsx(ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{ref:u,type:"text",value:g,onChange:m=>p(m.target.value),className:"w-full pl-10 pr-4 h-10 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white",placeholder:"Search suppliers...","aria-label":"Search suppliers"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-2",children:h?e.jsx(Ke,{message:"Loading suppliers"}):d.length>0?e.jsx("div",{className:"space-y-2",children:d.map(m=>e.jsxs("div",{className:"flex items-center gap-3 p-3 border rounded-lg cursor-pointer transition-all duration-200 border-gray-200 hover:border-green-400 hover:bg-green-50 bg-white active:scale-[0.98] touch-target",onClick:()=>{i(m),o()},tabIndex:0,role:"button","aria-label":`Select supplier ${m.name}`,onKeyDown:l=>{(l.key==="Enter"||l.key===" ")&&(i(m),o())},children:[e.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(ze,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate text-sm",children:m.name}),(m.contact_email||m.phone)&&e.jsxs("div",{className:"text-xs text-gray-600 truncate mt-0.5",children:[m.contact_email&&`${m.contact_email}`,m.phone&&m.contact_email&&" â€¢ ",m.phone&&`${m.phone}`]})]})]},m.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ze,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-sm",children:g?"No suppliers found matching your search":"No suppliers available"})]})}),e.jsxs("div",{className:"sticky bottom-0 bg-white border-t border-gray-100 p-4 safe-area-bottom space-y-2",children:[e.jsx("button",{className:"w-full h-12 rounded-lg bg-green-600 hover:bg-green-700 text-white font-medium text-sm transition-all duration-200 active:scale-[0.98] touch-target",onClick:()=>{},"aria-label":"Add Supplier",children:"Add Supplier"}),e.jsx("button",{ref:v,className:"w-full h-12 rounded-lg bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-gray-700 font-medium text-sm transition-all duration-200 active:scale-[0.98] touch-target",onClick:o,"aria-label":"Cancel",children:"Cancel"})]})]})}):null},ns=({onNavigateToSection:r})=>{const[o,i]=s.useState("management"),[b,c]=s.useState(null);s.useState(!1),s.useState(!1);const[g,p]=s.useState(!1),[N,h]=s.useState(!1);Je(),ps();const{userProfile:P}=cs(),v=Ye(),u=[{id:"printers-dashboard",title:"Printers",icon:he,description:"Printer fleet dashboard",color:"bg-indigo-50 border-indigo-200",activeColor:"bg-indigo-100 border-indigo-300 shadow-md",iconColor:"text-indigo-600",onClick:()=>v("/printer-dashboard")},{id:"clients",title:"Clients",icon:Re,description:"Client directory",color:"bg-orange-50 border-orange-200",activeColor:"bg-orange-100 border-orange-300 shadow-md",iconColor:"text-orange-600",onClick:()=>p(!0)},{id:"suppliers-dashboard",title:"Suppliers",icon:ze,description:"Supplier management",color:"bg-blue-50 border-blue-200",activeColor:"bg-blue-100 border-blue-300 shadow-md",iconColor:"text-blue-600",onClick:()=>h(!0)},{id:"sales-entry",title:"Sales",icon:qs,description:"Sales entry and transactions",color:"bg-pink-50 border-pink-200",activeColor:"bg-pink-100 border-pink-300 shadow-md",iconColor:"text-pink-600",onClick:()=>v("/sales-entry")},{id:"products",title:"Products",icon:Xe,description:"Product catalog",color:"bg-purple-50 border-purple-200",activeColor:"bg-purple-100 border-purple-300 shadow-md",iconColor:"text-purple-600",onClick:()=>v("/product-dashboard")}];return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50",children:[e.jsxs("div",{className:"sticky top-0 z-40 bg-white/95 backdrop-blur-sm border-b border-gray-200",children:[e.jsx(gs,{client:{id:"dashboard",name:"TechPinoy App",contact_email:"",phone:"",notes:"",address:"",department_count:0,location_count:0,printer_count:0,created_at:"",updated_at:""},onBack:()=>v("/"),onEdit:()=>{},appVersion:"1.0.0"}),e.jsx("div",{className:"px-3 pb-2",children:e.jsx(Us,{})})]}),e.jsxs("div",{className:"px-1 pt-2 pb-20 space-y-3",children:[e.jsx("div",{className:"mb-4",children:e.jsx(nt,{})}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 px-1",children:"Quick Access"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:u.filter(d=>(P==null?void 0:P.role)==="client"?d.id==="printers-dashboard"||d.id==="clients":!0).map(d=>{const m=d.icon,l=o===d.id;return e.jsx(me,{className:`cursor-pointer transition-all duration-200 ${l?d.activeColor:d.color} hover:shadow-lg transform hover:scale-[1.02] active:scale-[0.98] border-2`,onClick:()=>{i(d.id),c(null),d.onClick()},children:e.jsx(xe,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${d.color} shadow-sm`,children:e.jsx(m,{className:`h-7 w-7 ${d.iconColor}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 leading-tight",children:d.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:d.description})]})]}),e.jsx($s,{className:`h-6 w-6 transition-transform duration-200 flex-shrink-0 ${l?"rotate-90 text-gray-700":"text-gray-400"}`})]})})},d.id)})})]})]}),e.jsx(Bs,{isOpen:g,onClose:()=>p(!1),onClientSelected:d=>v(`/clients/${d.id}`),title:"Select a Client",description:"Choose a client to view their details."}),e.jsx(it,{isOpen:N,onClose:()=>h(!1),onSupplierSelected:d=>v(`/suppliers/${d.id}`),title:"Select a Supplier",description:"Choose a supplier to view their details."})]})},bs=({activeTab:r,onTabChange:o,tabs:i,showBackButton:b=!0,onBackClick:c,rightButton:g})=>{ds();const p=Ye(),h=i||[{id:"dashboard",label:"Home",icon:Ws},{id:"clients",label:"Clients",icon:Re},{id:"sales",label:"Sales",icon:Ee},{id:"printers",label:"Printers",icon:he},{id:"suppliers",label:"Suppliers",icon:fs},{id:"products",label:"Products",icon:Xe}],P=()=>{c?c():p("/")};function v(u){switch(u){case 2:return"grid-cols-2";case 3:return"grid-cols-3";case 4:return"grid-cols-4";case 5:return"grid-cols-5";case 6:return"grid-cols-6";case 7:return"grid-cols-7";case 8:return"grid-cols-8";default:return"grid-cols-1"}}return e.jsxs("nav",{className:"fixed bottom-0 left-0 w-full z-50 bg-white/95 backdrop-blur-lg border-t border-gray-200 shadow-2xl flex items-center px-1 sm:px-2 py-1 sm:py-2 transition-all safe-area-bottom",children:[b&&e.jsx("div",{className:"flex-shrink-0 sm:mr-2",children:e.jsx("button",{onClick:P,className:"h-12 w-12 rounded-lg flex items-center justify-center text-gray-500 hover:text-gray-700 hover:bg-gray-50 transition-all duration-200","aria-label":"Back",children:e.jsx(hs,{className:"h-5 w-5"})})}),e.jsx("div",{className:"flex-1 flex justify-center min-w-0",children:e.jsx("div",{className:`grid ${v(h.length)} w-full gap-1 max-w-md`,children:h.map(u=>{const d=u.icon,m=r===u.id;return e.jsxs("button",{onClick:()=>o(u.id),className:`h-12 w-full rounded-lg flex flex-col items-center justify-center gap-1 min-w-0 flex-1 transition-all duration-200 ${m?"bg-blue-600 text-white shadow-lg hover:bg-blue-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-50"}`,children:[d&&e.jsx(d,{size:16,className:`h-4 w-4 transition-transform duration-200 ${m?"scale-110 text-white":"text-gray-500"}`}),e.jsx("span",{className:`text-xs font-medium transition-all duration-200 ${m?"font-semibold text-white":""}`,children:u.label})]},u.id)})})}),e.jsx("div",{className:"flex-shrink-0 sm:ml-2",children:g||e.jsx("div",{className:"w-10"})})]})},is=()=>{const[r,o]=s.useState(""),[i,b]=s.useState([]),[c,g]=s.useState([]),[p,N]=s.useState(!0),[h,P]=s.useState("assigned"),v=async()=>{try{const{data:l,error:j}=await B.from("printers").select(`
          id,
          name,
          model,
          status,
          manufacturer,
          printer_type,
          product_printers(
            products(
              id,
              name
            )
          )
        `).order("name");if(j){console.error("Error fetching all printers:",j);return}const M=(l||[]).map(C=>{var _;return{id:C.id,name:C.name,model:C.model,status:C.status,manufacturer:C.manufacturer,printer_type:C.printer_type,products:((_=C.product_printers)==null?void 0:_.map(R=>R.products).filter(Boolean))||[]}});b(M)}catch(l){console.error("Error fetching all printers:",l)}},u=async()=>{try{const{data:l,error:j}=await B.from("printers").select(`
          id,
          name,
          model,
          status,
          manufacturer,
          printer_type,
          product_printers(
            products(
              id,
              name
            )
          )
        `).order("name");if(j){console.error("Error fetching printers:",j);return}const{data:M,error:C}=await B.from("printer_assignments").select(`
          printer_id,
          status,
          clients(
            name
          )
        `).eq("status","active");if(C){console.error("Error fetching assignments:",C);return}const _=(M==null?void 0:M.reduce((D,L)=>{var y;if(!L.printer_id||!((y=L.clients)!=null&&y.name))return D;D[L.printer_id]||(D[L.printer_id]={});const f=L.clients.name;return D[L.printer_id][f]=(D[L.printer_id][f]||0)+1,D},{}))||{},R=(l||[]).map(D=>{var y;const L=_[D.id]||{},f=Object.entries(L).map(([F,$])=>({clientName:F,count:$}));return{id:D.id,name:D.name,model:D.model,status:D.status,manufacturer:D.manufacturer,printer_type:D.printer_type,assignedClients:f,products:((y=D.product_printers)==null?void 0:y.map(F=>F.products).filter(Boolean))||[]}});g(R)}catch(l){console.error("Error fetching assigned printers:",l)}};s.useEffect(()=>{(async()=>{N(!0),h==="all"?await v():await u(),N(!1)})()},[h]);const m=h==="all"?i.filter(l=>l.name.toLowerCase().includes(r.toLowerCase())||l.model&&l.model.toLowerCase().includes(r.toLowerCase())||l.manufacturer&&l.manufacturer.toLowerCase().includes(r.toLowerCase())||l.products.some(j=>j.name.toLowerCase().includes(r.toLowerCase()))):c.filter(l=>l.name.toLowerCase().includes(r.toLowerCase())||l.model&&l.model.toLowerCase().includes(r.toLowerCase())||l.manufacturer&&l.manufacturer.toLowerCase().includes(r.toLowerCase())||l.assignedClients.some(j=>j.clientName.toLowerCase().includes(r.toLowerCase()))||l.products.some(j=>j.name.toLowerCase().includes(r.toLowerCase())));return e.jsxs("div",{className:"p-4 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Printers"}),e.jsxs(q,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(se,{size:16,className:"mr-2"}),"Add Printer"]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(ue,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(Q,{placeholder:"Search printers, models, clients, or products...",value:r,onChange:l=>o(l.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex space-x-2 mb-4",children:[e.jsx(q,{variant:h==="assigned"?"default":"outline",size:"sm",className:h==="assigned"?"bg-blue-600 hover:bg-blue-700 px-6":"px-6",onClick:()=>P("assigned"),children:"Assigned"}),e.jsx(q,{variant:h==="all"?"default":"outline",size:"sm",className:h==="all"?"bg-blue-600 hover:bg-blue-700 px-6":"px-6",onClick:()=>P("all"),children:"All Printers"})]}),p?e.jsx(Ke,{message:"Loading printers"}):m.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(he,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:r?"No printers found":"No printers yet"}),e.jsx("p",{className:"text-gray-400 mb-4",children:r?"Try adjusting your search terms":"Start by adding your first printer"}),!r&&e.jsxs(q,{children:[e.jsx(se,{size:16,className:"mr-2"}),"Add Your First Printer"]})]}):e.jsx("div",{className:"space-y-3",children:m.map(l=>e.jsx(me,{className:"hover:shadow-md transition-shadow cursor-pointer",children:e.jsx(xe,{className:"p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(he,{size:20,className:"text-blue-600"})})}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:l.name}),l.model&&e.jsxs("span",{className:"text-sm text-gray-500",children:["(",l.model,")"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[l.manufacturer&&e.jsx(U,{variant:"outline",className:"text-xs",children:l.manufacturer}),l.printer_type&&e.jsx(U,{variant:"secondary",className:"text-xs",children:l.printer_type})]})]}),h==="assigned"?e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Assigned To:"}),l.assignedClients.length>0?e.jsx("div",{className:"flex flex-wrap gap-1",children:l.assignedClients.map((j,M)=>e.jsxs(U,{variant:"outline",className:"text-xs",children:[j.clientName," (",j.count,")"]},M))}):e.jsx(U,{variant:"outline",className:"text-xs text-gray-500",children:"Unassigned"})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Status:"}),e.jsx(U,{className:l.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800",children:l.status||"Unknown"})]}),l.products.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Compatible Products:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:l.products.map(j=>e.jsx(U,{variant:"secondary",className:"text-xs",children:j.name},j.id))})]})]})]})})},l.id))})]})},ot=()=>{const[r,o]=s.useState(""),b=[{id:"1",name:"Meyink",type:"supplier"},{id:"2",name:"Starink",type:"supplier"},{id:"3",name:"TonerPro",type:"supplier"},{id:"4",name:"ZK Import",type:"supplier"}].filter(c=>c.name.toLowerCase().includes(r.toLowerCase()));return e.jsxs("div",{className:"p-4 pb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Suppliers"}),e.jsxs(q,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(se,{size:16,className:"mr-2"}),"Add Supplier"]})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(ue,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx(Q,{placeholder:"Search suppliers...",value:r,onChange:c=>o(c.target.value),className:"pl-10"})]})}),b.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Re,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-500 mb-2",children:r?"No suppliers found":"No suppliers yet"}),e.jsx("p",{className:"text-gray-400 mb-4",children:r?"Try adjusting your search terms":"Start by adding your first supplier"}),!r&&e.jsxs(q,{children:[e.jsx(se,{size:16,className:"mr-2"}),"Add Your First Supplier"]})]}):e.jsx("div",{className:"space-y-3",children:b.map(c=>e.jsx(me,{className:"hover:shadow-md transition-shadow cursor-pointer",children:e.jsx(xe,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Re,{size:20,className:"text-blue-600"})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("h3",{className:"font-semibold text-gray-900",children:c.name})})]})})},c.id))})]})},ct=({onBack:r})=>{const[o,i]=s.useState("printers"),b=()=>{switch(o){case"printers":return e.jsx(is,{});case"suppliers":return e.jsx(ot,{});default:return e.jsx(is,{})}};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx("div",{className:"p-4 border-b bg-white sticky top-0 z-10",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(q,{variant:"ghost",size:"sm",onClick:r,className:"p-2",children:e.jsx(hs,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-lg font-semibold",children:"Management"})]})}),e.jsx("main",{className:"flex-1 overflow-y-auto pb-20",children:b()}),e.jsx(bs,{activeTab:o,onTabChange:i,tabs:[{id:"printers",label:"Printers"},{id:"suppliers",label:"Suppliers"}]})]})},dt=()=>{const[r,o]=s.useState([]),[i,b]=s.useState("pos"),c=r.reduce((N,h)=>N+h.totalAmount,0),g=r.filter(N=>N.status==="pending").length,p=r.filter(N=>N.status==="paid").length;return e.jsxs("div",{className:"px-4 py-4 pb-24",children:[e.jsx("div",{className:"mb-6",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Sales Management"})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[e.jsx(me,{className:"rounded-xl shadow-md",children:e.jsxs(xe,{className:"p-4 text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["â‚±",c.toFixed(2)]}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Total Sales"})]})}),e.jsx(me,{className:"rounded-xl shadow-md",children:e.jsxs(xe,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:g}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Pending Sales"})]})}),e.jsx(me,{className:"rounded-xl shadow-md",children:e.jsxs(xe,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:p}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Completed Sales"})]})})]}),e.jsxs(Qs,{value:i,onValueChange:b,className:"w-full",children:[e.jsxs(Vs,{className:"grid w-full grid-cols-4 mb-6",children:[e.jsxs(Me,{value:"pos",className:"flex items-center space-x-2",children:[e.jsx(Ee,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"POS"})]}),e.jsxs(Me,{value:"transactions",className:"flex items-center space-x-2",children:[e.jsx(se,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Sales"})]}),e.jsxs(Me,{value:"purchase-orders",className:"flex items-center space-x-2",children:[e.jsx(Ze,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"PO"})]}),e.jsxs(Me,{value:"deliveries",className:"flex items-center space-x-2",children:[e.jsx(fs,{size:16}),e.jsx("span",{className:"hidden sm:inline",children:"Deliveries"})]})]}),e.jsx(Ie,{value:"pos",children:e.jsx(_e,{sales:r,setSales:o,activeTab:"pos"})}),e.jsx(Ie,{value:"transactions",children:e.jsx(_e,{sales:r,setSales:o,activeTab:"transactions"})}),e.jsx(Ie,{value:"purchase-orders",children:e.jsx(_e,{sales:r,setSales:o,activeTab:"purchase-orders"})}),e.jsx(Ie,{value:"deliveries",children:e.jsx(_e,{sales:r,setSales:o,activeTab:"deliveries"})})]})]})},mt=({onBack:r})=>{const[o,i]=s.useState("overview"),b=Ye(),c=()=>{switch(o){case"overview":return e.jsx(ls,{});case"sales":return e.jsx(dt,{});case"purchase-orders":return e.jsx("div",{className:"px-4 py-4",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Purchase Orders - Coming Soon"})});case"deliveries":return e.jsx("div",{className:"px-4 py-4",children:e.jsx("h2",{className:"text-lg font-semibold",children:"Deliveries - Coming Soon"})});default:return e.jsx(ls,{})}},g={id:"sales-dashboard",name:"Sales Dashboard",contact_email:"",phone:"",notes:"",address:"",contact_person:"",department_count:0,printer_count:0,location_count:0,created_at:"",updated_at:""};return e.jsxs("div",{className:"min-h-screen bg-white",children:[e.jsx(gs,{client:g,onBack:()=>b("/"),onEdit:()=>{},appVersion:"1.0.0"}),e.jsx("main",{className:"flex-1 overflow-y-auto pb-20",children:c()}),e.jsx(bs,{activeTab:o,onTabChange:p=>{p==="overview"?b("/overview"):i(p)},tabs:[{id:"overview",label:"Overview"},{id:"sales",label:"Sales"},{id:"purchase-orders",label:"Purchase Order"},{id:"deliveries",label:"Deliveries"}]})]})},xt=({open:r,onOpenChange:o,versionInfo:i,currentVersion:b,onUpdate:c,onRemindLater:g})=>{const p=u=>{switch(u){case"critical":return e.jsx(Ss,{className:"h-5 w-5"});case"beta":return e.jsx(Rs,{className:"h-5 w-5"});default:return e.jsx(Es,{className:"h-5 w-5"})}},N=u=>{switch(u){case"critical":return"destructive";case"beta":return"secondary";default:return"default"}},h=u=>{switch(u){case"critical":return"Critical Update";case"beta":return"Beta Release";default:return"Feature Update"}},P=u=>new Date(u).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),v=u=>u?`${(u/(1024*1024)).toFixed(1)} MB`:"";return e.jsx(ms,{open:r,onOpenChange:o,children:e.jsxs(xs,{className:"max-w-md",children:[e.jsxs(us,{className:"flex items-center gap-2",children:[p(i.updateType),"What's New in v",i.version]}),e.jsx(vs,{asChild:!0,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(U,{variant:N(i.updateType),className:"flex items-center gap-1",children:[p(i.updateType),h(i.updateType)]}),i.isRequired&&e.jsx(U,{variant:"destructive",className:"text-xs",children:"Required"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Current Version:"}),e.jsxs("span",{className:"font-medium",children:["v",b]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"New Version:"}),e.jsxs("span",{className:"font-medium text-blue-600",children:["v",i.version]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Release Date:"}),e.jsx("span",{className:"font-medium",children:P(i.releaseDate)})]}),i.fileSize&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Download Size:"}),e.jsx("span",{className:"font-medium",children:v(i.fileSize)})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"What's New:"}),e.jsx("ul",{className:"space-y-1",children:i.whatsNew.map((u,d)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-700",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),u]},d))})]})]})}),e.jsxs(ws,{className:"flex-col sm:flex-row gap-2",children:[!i.isRequired&&e.jsxs(q,{variant:"ghost",onClick:g,className:"flex items-center gap-2",children:[e.jsx(Gs,{className:"h-4 w-4"}),"Remind Me Later"]}),e.jsxs(q,{onClick:c,className:"flex items-center gap-2",variant:i.updateType==="critical"?"destructive":"default",children:[e.jsx(zs,{className:"h-4 w-4"}),i.updateType==="critical"?"Update Now":"Download Update"]})]})]})})},Qt=()=>{const[r,o]=s.useState("home"),{hasUpdates:i,showWhatsNew:b,handleUpdate:c,handleRemindLater:g,handleCloseWhatsNew:p,latestVersionInfo:N}=Fs({currentVersion:as,enableNotifications:!0,enableBackgroundChecks:!0}),h=v=>{o(v)},P=()=>{switch(r){case"home":return e.jsx(ns,{onNavigateToSection:h});case"management":return e.jsx(ct,{onBack:()=>o("home")});case"sales":return e.jsx(mt,{onBack:()=>o("home")});default:return e.jsx(ns,{onNavigateToSection:h})}};return e.jsxs("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-slate-50 to-blue-50 relative",children:[e.jsx("main",{className:"flex-1 overflow-y-auto overscroll-contain",children:e.jsx("div",{className:"min-h-screen pb-16",children:P()})}),N&&e.jsx(xt,{open:b,onOpenChange:p,versionInfo:N,currentVersion:as,onUpdate:c,onRemindLater:g})]})};export{Qt as default};
//# sourceMappingURL=Index-BlwpEWLd.js.map
