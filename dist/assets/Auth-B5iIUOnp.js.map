{"version":3,"file":"Auth-B5iIUOnp.js","sources":["../../node_modules/lucide-react/dist/esm/icons/eye-off.js","../../node_modules/lucide-react/dist/esm/icons/smartphone.js","../../src/pages/Auth.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.462.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst EyeOff = createLucideIcon(\"EyeOff\", [\n  [\n    \"path\",\n    {\n      d: \"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49\",\n      key: \"ct8e1f\"\n    }\n  ],\n  [\"path\", { d: \"M14.084 14.158a3 3 0 0 1-4.242-4.242\", key: \"151rxh\" }],\n  [\n    \"path\",\n    {\n      d: \"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143\",\n      key: \"13bj9a\"\n    }\n  ],\n  [\"path\", { d: \"m2 2 20 20\", key: \"1ooewy\" }]\n]);\n\nexport { EyeOff as default };\n//# sourceMappingURL=eye-off.js.map\n","/**\n * @license lucide-react v0.462.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Smartphone = createLucideIcon(\"Smartphone\", [\n  [\"rect\", { width: \"14\", height: \"20\", x: \"5\", y: \"2\", rx: \"2\", ry: \"2\", key: \"1yt0o3\" }],\n  [\"path\", { d: \"M12 18h.01\", key: \"mhygvu\" }]\n]);\n\nexport { Smartphone as default };\n//# sourceMappingURL=smartphone.js.map\n","import React, { useState, useEffect } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport { Eye, EyeOff, Loader2, Download, Smartphone } from 'lucide-react';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Input } from '@/components/ui/input';\r\nimport { useAuth } from '@/hooks/useAuth';\r\nimport { useClientEmailRedirect } from '@/hooks/useClientEmailRedirect';\r\nimport { useToast } from '@/hooks/use-toast';\r\nimport logo from '../img/logo.png';\r\n\r\nconst Auth = () => {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [showPassword, setShowPassword] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n  const { signIn, user, userProfile, userProfileLoading } = useAuth();\r\n  const { redirectToClientIfMatched } = useClientEmailRedirect();\r\n  const { toast } = useToast();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  // Role-based redirect logic\r\n  useEffect(() => {\r\n    if (user && !userProfileLoading && userProfile) {\r\n      console.log('ðŸ”„ User authenticated, checking role-based redirect');\r\n      \r\n      const userRole = userProfile.role;\r\n      console.log('ðŸ‘¤ User role:', userRole);\r\n      \r\n      switch (userRole) {\r\n        case 'admin':\r\n        case 'sales_admin':\r\n          console.log('ðŸ  Admin user - redirecting to admin route');\r\n          navigate('/admin', { replace: true });\r\n          break;\r\n        case 'client':\r\n          console.log('ðŸ  Client user - redirecting to home route');\r\n          navigate('/', { replace: true });\r\n          break;\r\n        default:\r\n          console.log('ðŸš« User role - redirecting to user route');\r\n          navigate('/user', { replace: true });\r\n          break;\r\n      }\r\n    }\r\n  }, [user, userProfile, userProfileLoading, navigate]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    try {\r\n      const { error } = await signIn(email, password);\r\n      if (error) {\r\n        toast({\r\n          title: 'Authentication Error',\r\n          description: error.message,\r\n          variant: 'destructive'\r\n        });\r\n      }\r\n    } catch (error) {\r\n      toast({\r\n        title: 'Error',\r\n        description: 'An unexpected error occurred',\r\n        variant: 'destructive'\r\n      });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleAndroidDownload = async () => {\r\n    try {\r\n      // Fetch the directory listing for /apk/\r\n      const response = await fetch('/apk/');\r\n      if (!response.ok) throw new Error('Could not access APK directory');\r\n      const html = await response.text();\r\n\r\n      // Find all APK files matching the pattern\r\n      const matches = [...html.matchAll(/href=\"(app-release-v[0-9.]+-\\d+_\\d+\\.apk)\"/g)];\r\n      if (!matches.length) {\r\n        toast({\r\n          title: 'Download Error',\r\n          description: 'No APK files found.',\r\n          variant: 'destructive'\r\n        });\r\n        return;\r\n      }\r\n\r\n      // Extract filenames and sort by timestamp in the filename\r\n      const files = matches.map(m => m[1]);\r\n      files.sort((a, b) => {\r\n        // Extract the timestamp part (after the last dash, before .apk)\r\n        const getTimestamp = (fname) => {\r\n          const match = fname.match(/-(\\d{8}_\\d{4})\\.apk$/);\r\n          return match ? match[1] : '';\r\n        };\r\n        return getTimestamp(a) < getTimestamp(b) ? 1 : -1;\r\n      });\r\n\r\n      // The first file is the latest\r\n      const latestApk = files[0];\r\n      window.open(`/apk/${latestApk}`, '_blank');\r\n      toast({\r\n        title: 'Download Started',\r\n        description: `Downloading ${latestApk}`,\r\n        variant: 'default'\r\n      });\r\n    } catch (error) {\r\n      toast({\r\n        title: 'Download Error',\r\n        description: 'Failed to download APK. Please try again.',\r\n        variant: 'destructive'\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleIOSDownload = () => {\r\n    toast({\r\n      title: 'Exciting News! ðŸŽ‰',\r\n      description: 'Our TechPinoy App for iOS is still being developed. Stay tuned for the release!',\r\n      variant: 'default'\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-50 to-blue-50 flex items-center justify-center p-4\">\r\n      <div className=\"w-full max-w-md\">\r\n        <div className=\"bg-white rounded-xl shadow-lg p-8\">\r\n          <div className=\"text-center mb-8\">\r\n            <div className=\"inline-block mb-4\">\r\n              <img src={logo} alt=\"TechPinoy Logo\" className=\"h-16 w-16\" />\r\n            </div>\r\n            <h1 className=\"text-2xl font-bold text-gray-900\">TechPinoy App</h1>\r\n            <p className=\"text-gray-600 mt-2\">Sign in to your account</p>\r\n          </div>\r\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n            <div>\r\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Username\r\n              </label>\r\n              <Input \r\n                id=\"email\" \r\n                type=\"email\" \r\n                value={email} \r\n                onChange={e => setEmail(e.target.value)} \r\n                placeholder=\"Enter your email\" \r\n                required \r\n                className=\"w-full\" \r\n              />\r\n            </div>\r\n            <div>\r\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Password\r\n              </label>\r\n              <div className=\"relative\">\r\n                <Input \r\n                  id=\"password\" \r\n                  type={showPassword ? 'text' : 'password'} \r\n                  value={password} \r\n                  onChange={e => setPassword(e.target.value)} \r\n                  placeholder=\"Enter your password\" \r\n                  required \r\n                  className=\"w-full pr-10\" \r\n                />\r\n                <button \r\n                  type=\"button\" \r\n                  onClick={() => setShowPassword(!showPassword)} \r\n                  className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600\"\r\n                >\r\n                  {showPassword ? <EyeOff className=\"h-4 w-4\" /> : <Eye className=\"h-4 w-4\" />}\r\n                </button>\r\n              </div>\r\n            </div>\r\n            \r\n            <Button type=\"submit\" className=\"w-full\" disabled={loading}>\r\n              {loading && <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />}\r\n              Sign In\r\n            </Button>\r\n          </form>\r\n          \r\n          {/* Compact Download App Section */}\r\n          <div className=\"mt-6 pt-4 border-t border-gray-100\">\r\n            <div className=\"text-center\">\r\n              <div className=\"flex items-center justify-center gap-2 mb-3\">\r\n                <Smartphone className=\"h-4 w-4 text-blue-600\" />\r\n                <h3 className=\"text-sm font-semibold text-gray-700\">Download TechPinoy App</h3>\r\n              </div>\r\n              <p className=\"text-xs text-gray-500 mb-3\">Get the full experience on your mobile device</p>\r\n              \r\n              <div className=\"flex justify-center gap-4\">\r\n                <button\r\n                  onClick={handleAndroidDownload}\r\n                  className=\"p-2.5 bg-black hover:bg-gray-800 text-white rounded-full transition-colors duration-200 shadow-sm hover:shadow-md\"\r\n                  title=\"Download for Android\"\r\n                >\r\n                  <svg className=\"h-5 w-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                    <path d=\"M17.523 15.3414c-.5511 0-.9993-.4486-.9993-.9997s.4482-.9993.9993-.9993c.5511 0 .9993.4482.9993.9993.0001.5511-.4482.9997-.9993.9997m-11.046 0c-.5511 0-.9993-.4486-.9993-.9997s.4482-.9993.9993-.9993c.5511 0 .9993.4482.9993.9993 0 .5511-.4482.9997-.9993.9997m11.4045-6.02l1.9973-3.4592a.416.416 0 00-.1521-.5676.416.416 0 00-.5676.1521l-2.0223 3.5036C15.5902 8.2432 13.8533 7.4287 11.9797 7.4287c-1.8736 0-3.6105.8145-4.8057 2.0786L5.1517 5.9995a.416.416 0 00-.5676-.1521.416.416 0 00-.1521.5676l1.9973 3.4592C2.6889 11.1867.3432 14.6589 0 18.761h23.959c-.3432-4.1021-2.6889-7.5743-6.5775-9.4396\"/>\r\n                  </svg>\r\n                </button>\r\n                <button\r\n                  onClick={handleIOSDownload}\r\n                  className=\"p-2.5 bg-gray-800 hover:bg-gray-700 text-white rounded-full transition-colors duration-200 shadow-sm hover:shadow-md\"\r\n                  title=\"Download for iOS\"\r\n                >\r\n                  <svg className=\"h-5 w-5\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                    <path d=\"M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z\"/>\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        \r\n        {/* Developer Credit */}\r\n        <div className=\"text-center mt-6\">\r\n          <p className=\"text-xs text-gray-400\">\r\n            TechPinoy App Developed by James Chavez\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Auth;\r\n"],"names":["EyeOff","createLucideIcon","Smartphone","Auth","email","setEmail","useState","password","setPassword","showPassword","setShowPassword","loading","setLoading","signIn","user","userProfile","userProfileLoading","useAuth","useClientEmailRedirect","toast","useToast","navigate","useNavigate","useLocation","useEffect","userRole","handleSubmit","e","error","handleAndroidDownload","response","matches","files","m","a","b","getTimestamp","fname","match","latestApk","handleIOSDownload","jsxs","jsx","logo","Input","Eye","Button","Loader2"],"mappings":"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","x_google_ignoreList":[0,1]}