{"version":3,"file":"AddPurchaseModal-DW33EB1L.js","sources":["../../src/SalesDashboard/AddPurchaseModal.tsx"],"sourcesContent":["import { useState } from 'react';\r\nimport { Plus, Minus, FileText, User, Calendar } from 'lucide-react';\r\nimport { Input } from '@/components/ui/input';\r\nimport { Label } from '@/components/ui/label';\r\nimport { Textarea } from '@/components/ui/textarea';\r\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\r\nimport { usePurchaseOrdersEnhanced } from '@/hooks/usePurchaseOrdersEnhanced';\r\nimport { CreatePurchaseOrderData } from '@/types/purchaseOrder';\r\n\r\ninterface AddPurchaseModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  onSuccess?: () => void;\r\n}\r\n\r\ninterface POItemForm {\r\n  product_id?: string;\r\n  model?: string;\r\n  quantity: number;\r\n  unit_price: number;\r\n}\r\n\r\nexport const AddPurchaseModal = ({ isOpen, onClose, onSuccess }: AddPurchaseModalProps) => {\r\n  const { createPurchaseOrder } = usePurchaseOrdersEnhanced();\r\n  const [loading, setLoading] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    supplier_name: '',\r\n    status: 'pending' as const,\r\n    payment_status: 'unpaid' as const,\r\n    notes: ''\r\n  });\r\n  const [items, setItems] = useState<POItemForm[]>([\r\n    { model: '', quantity: 1, unit_price: 0 }\r\n  ]);\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    try {\r\n      const poData: CreatePurchaseOrderData = {\r\n        supplier_name: formData.supplier_name,\r\n        status: formData.status,\r\n        payment_status: formData.payment_status,\r\n        notes: formData.notes,\r\n        items: items.filter(item => item.model && item.quantity > 0)\r\n      };\r\n      await createPurchaseOrder(poData);\r\n      onSuccess?.();\r\n      onClose();\r\n    } catch (error) {\r\n      console.error('Error creating purchase order:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const updateItem = (index: number, field: keyof POItemForm, value: any) => {\r\n    setItems(prev => prev.map((item, i) => i === index ? { ...item, [field]: value } : item));\r\n  };\r\n  const addItem = () => {\r\n    setItems(prev => [...prev, { model: '', quantity: 1, unit_price: 0 }]);\r\n  };\r\n  const removeItem = (index: number) => {\r\n    setItems(prev => prev.filter((_, i) => i !== index));\r\n  };\r\n  const calculateTotal = () => {\r\n    return items.reduce((sum, item) => sum + (item.quantity * item.unit_price), 0);\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-[9999] flex flex-col bg-gradient-to-br from-purple-50 to-violet-50 animate-in fade-in-0 slide-in-from-bottom-8\">\r\n      {/* Sticky Header */}\r\n      <div className=\"sticky top-0 z-10 bg-purple-100/90 p-4 flex items-center justify-between border-b border-purple-200 rounded-b-xl shadow-sm\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <FileText className=\"w-6 h-6 text-purple-500\" />\r\n          <span className=\"text-lg font-semibold\">New Purchase Order</span>\r\n        </div>\r\n        <button onClick={onClose} className=\"p-2 rounded-full hover:bg-purple-200 transition\" aria-label=\"Close\">\r\n          <Minus className=\"h-5 w-5 text-purple-500\" />\r\n        </button>\r\n      </div>\r\n      {/* Scrollable Content */}\r\n      <form\r\n        onSubmit={handleSubmit}\r\n        className=\"flex-1 overflow-y-auto p-4 space-y-6 pb-28 sm:pb-8\" // pb-28 for mobile sticky bar, sm:pb-8 for desktop\r\n      >\r\n        {/* Supplier & Status Section */}\r\n        <div className=\"bg-gradient-to-r from-purple-50 to-violet-50 rounded-xl p-4 space-y-4 border border-purple-100\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <User className=\"w-5 h-5 text-purple-400\" />\r\n            <label className=\"block text-base font-semibold\">Supplier Name</label>\r\n          </div>\r\n          <Input\r\n            id=\"supplier_name\"\r\n            value={formData.supplier_name}\r\n            onChange={(e) => setFormData(prev => ({ ...prev, supplier_name: e.target.value }))}\r\n            required\r\n            className=\"h-12 text-base\"\r\n          />\r\n          <div className=\"flex items-center gap-3 mt-4\">\r\n            <Calendar className=\"w-5 h-5 text-purple-400\" />\r\n            <label className=\"block text-base font-semibold\">Status</label>\r\n          </div>\r\n          <Select value={formData.status} onValueChange={(value: any) => setFormData(prev => ({ ...prev, status: value }))}>\r\n            <SelectTrigger className=\"h-12 text-base border border-purple-200\">\r\n              <SelectValue />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"pending\">Pending</SelectItem>\r\n              <SelectItem value=\"partial\">Partial</SelectItem>\r\n              <SelectItem value=\"completed\">Completed</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n        </div>\r\n        {/* Payment Status & Notes Section */}\r\n        <div className=\"bg-gradient-to-r from-purple-50 to-violet-50 rounded-xl p-4 space-y-4 border border-purple-100\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <FileText className=\"w-5 h-5 text-purple-400\" />\r\n            <label className=\"block text-base font-semibold\">Payment Status</label>\r\n          </div>\r\n          <Select value={formData.payment_status} onValueChange={(value: any) => setFormData(prev => ({ ...prev, payment_status: value }))}>\r\n            <SelectTrigger className=\"h-12 text-base border border-purple-200\">\r\n              <SelectValue />\r\n            </SelectTrigger>\r\n            <SelectContent>\r\n              <SelectItem value=\"unpaid\">Unpaid</SelectItem>\r\n              <SelectItem value=\"partial\">Partial</SelectItem>\r\n              <SelectItem value=\"paid\">Paid</SelectItem>\r\n            </SelectContent>\r\n          </Select>\r\n          <label className=\"block text-base font-semibold mt-4\">Notes</label>\r\n          <Textarea\r\n            id=\"notes\"\r\n            placeholder=\"Optional notes\"\r\n            value={formData.notes}\r\n            onChange={(e) => setFormData(prev => ({ ...prev, notes: e.target.value }))}\r\n            className=\"h-12 text-base\"\r\n          />\r\n        </div>\r\n        {/* Items Section */}\r\n        <div className=\"bg-gradient-to-r from-orange-50 to-amber-50 rounded-xl p-4 border border-orange-100 space-y-4\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <label className=\"block text-base font-semibold flex items-center gap-2\"><FileText className=\"w-5 h-5 text-orange-400\" />Items</label>\r\n            <button type=\"button\" className=\"h-12 px-4 rounded-lg bg-orange-600 hover:bg-orange-700 text-white font-semibold shadow transition flex items-center gap-2\" onClick={addItem}>\r\n              <Plus size={18} /> Add Item\r\n            </button>\r\n          </div>\r\n          {items.map((item, index) => (\r\n            <div key={index} className=\"border rounded-xl p-4 space-y-3 bg-white\">\r\n              <div className=\"flex justify-between items-start\">\r\n                <h4 className=\"font-medium\">Item {index + 1}</h4>\r\n                {items.length > 1 && (\r\n                  <button\r\n                    type=\"button\"\r\n                    className=\"h-10 w-10 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600\"\r\n                    onClick={() => removeItem(index)}\r\n                  >\r\n                    <Minus size={18} />\r\n                  </button>\r\n                )}\r\n              </div>\r\n              <div className=\"grid grid-cols-1 sm:grid-cols-3 gap-3\">\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"block text-sm font-medium\">Model/Product</label>\r\n                  <Input\r\n                    placeholder=\"Product model\"\r\n                    value={item.model || ''}\r\n                    onChange={(e) => updateItem(index, 'model', e.target.value)}\r\n                    required\r\n                    className=\"h-12 text-base\"\r\n                  />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"block text-sm font-medium\">Quantity</label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    min=\"1\"\r\n                    value={item.quantity}\r\n                    onChange={(e) => updateItem(index, 'quantity', parseInt(e.target.value) || 1)}\r\n                    required\r\n                    className=\"h-12 text-base\"\r\n                  />\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <label className=\"block text-sm font-medium\">Unit Price</label>\r\n                  <Input\r\n                    type=\"number\"\r\n                    min=\"0\"\r\n                    step=\"0.01\"\r\n                    value={item.unit_price}\r\n                    onChange={(e) => updateItem(index, 'unit_price', parseFloat(e.target.value) || 0)}\r\n                    required\r\n                    className=\"h-12 text-base\"\r\n                  />\r\n                </div>\r\n              </div>\r\n              <div className=\"text-right text-sm text-gray-600\">\r\n                Subtotal: ₱{(item.quantity * item.unit_price).toFixed(2)}\r\n              </div>\r\n            </div>\r\n          ))}\r\n          <div className=\"text-right border-t pt-3\">\r\n            <div className=\"text-lg font-semibold\">\r\n              Total: ₱{calculateTotal().toFixed(2)}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        {/* Footer (not sticky, just at the end of the form) */}\r\n        <div className=\"bg-white border-t border-orange-100 p-4 flex flex-col sm:flex-row justify-end space-y-2 sm:space-y-0 sm:space-x-2 rounded-t-xl mt-4\">\r\n          <button\r\n            type=\"button\"\r\n            className=\"h-12 px-6 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold w-full sm:w-auto\"\r\n            onClick={onClose}\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            type=\"submit\"\r\n            className=\"h-12 px-6 rounded-lg bg-orange-600 hover:bg-orange-700 text-white font-semibold w-full sm:w-auto\"\r\n            disabled={loading}\r\n          >\r\n            {loading ? 'Creating...' : 'Create Purchase Order'}\r\n          </button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}; "],"names":["AddPurchaseModal","isOpen","onClose","onSuccess","createPurchaseOrder","usePurchaseOrdersEnhanced","loading","setLoading","useState","formData","setFormData","items","setItems","handleSubmit","e","poData","item","error","updateItem","index","field","value","prev","i","addItem","removeItem","_","calculateTotal","sum","jsxs","jsx","FileText","Minus","User","Input","Calendar","Select","SelectTrigger","SelectValue","SelectContent","SelectItem","Textarea","Plus"],"mappings":"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"}